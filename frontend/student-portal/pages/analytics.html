<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics - File Submission Portal</title>
    <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="../styles/analytics.css">
    <link rel="stylesheet" href="../styles/global-search.css">
    <link rel="stylesheet" href="../styles/notifications.css">
    <link rel="stylesheet" href="../styles/transitions.css">
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class='bx bx-file'></i>
                <span>FilePortal</span>
            </div>
        </div>

        <nav class="sidebar-nav">
            <a href="dashboard.html" class="nav-item">
                <i class='bx bx-home'></i>
                <span>Dashboard</span>
            </a>
            <a href="upload.html" class="nav-item">
                <i class='bx bx-upload'></i>
                <span>Upload Files</span>
            </a>
            <a href="submissions.html" class="nav-item">
                <i class='bx bx-folder'></i>
                <span>My Submissions</span>
            </a>
            <a href="feedback.html" class="nav-item">
                <i class='bx bx-message-square-detail'></i>
                <span>Feedback & Grades</span>
            </a>
            <a href="collaboration.html" class="nav-item">
                <i class='bx bx-group'></i>
                <span>Collaboration</span>
            </a>
            <a href="calendar.html" class="nav-item">
                <i class='bx bx-calendar'></i>
                <span>Calendar</span>
            </a>
            <a href="analytics.html" class="nav-item active">
                <i class='bx bx-bar-chart'></i>
                <span>Analytics</span>
            </a>
            <a href="chat.html" class="nav-item">
                <i class='bx bx-message-dots'></i>
                <span>Messages</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <a href="settings.html" class="nav-item">
                <i class='bx bx-cog'></i>
                <span>Settings</span>
            </a>
            <a href="../../shared/pages/login.html" class="nav-item">
                <i class='bx bx-log-out'></i>
                <span>Logout</span>
            </a>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Top Bar -->
        <header class="topbar">
            <div class="topbar-left">
                <button class="menu-toggle" id="menuToggle">
                    <i class='bx bx-menu'></i>
                </button>
                <h1>Analytics</h1>
            </div>
            
            <!-- Global Search -->
            <div class="global-search-container">
                <div class="global-search-wrapper">
                    <i class='bx bx-search search-icon'></i>
                    <input type="text" id="globalSearchInput" class="global-search-input" placeholder="Search submissions, feedback, groups..." autocomplete="off">
                    <span class="search-shortcut">Ctrl+K</span>
                </div>
                <div id="globalSearchResults" class="global-search-results"></div>
            </div>
            
            <div class="topbar-right">
                <div class="time-filter">
                    <button class="filter-btn">Week</button>
                    <button class="filter-btn active">Month</button>
                    <button class="filter-btn">Year</button>
                </div>
                <button class="notification-btn">
                    <i class='bx bx-bell'></i>
                    <span class="badge">3</span>
                </button>
                <div class="profile-menu">
                    <img src="https://ui-avatars.com/api/?name=Student+User&background=667eea&color=fff" alt="Profile">
                    <span>Student User</span>
                    <i class='bx bx-chevron-down'></i>
                </div>
            </div>
        </header>

        <!-- Analytics Container -->
        <div class="analytics-container">
            <!-- Stats Overview -->
            <div class="stats-overview">
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <i class='bx bx-file'></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalSubmissions">24</h3>
                        <p>Total Submissions</p>
                        <div class="stat-trend up">
                            <i class='bx bx-trending-up'></i>
                            <span>+12% from last month</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class='bx bx-check-circle'></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="onTimeSubmissions">20</h3>
                        <p>On-Time Submissions</p>
                        <div class="stat-trend up">
                            <i class='bx bx-trending-up'></i>
                            <span>+5% improvement</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon orange">
                        <i class='bx bx-medal'></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="averageGrade">85%</h3>
                        <p>Average Grade</p>
                        <div class="stat-trend up">
                            <i class='bx bx-trending-up'></i>
                            <span>+3% increase</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon red">
                        <i class='bx bx-target-lock'></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="completionRate">92%</h3>
                        <p>Completion Rate</p>
                        <div class="stat-trend up">
                            <i class='bx bx-trending-up'></i>
                            <span>Excellent!</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts Grid -->
            <div class="charts-grid">
                <!-- Submission Trend -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>Submission Trend</h3>
                        <div class="chart-legend">
                            <div class="legend-item">
                                <div class="legend-dot" style="background: linear-gradient(135deg, #667eea, #764ba2);"></div>
                                <span>Submissions</span>
                            </div>
                        </div>
                    </div>
                    <div id="submissionChart" class="submission-chart">
                        <!-- Chart will be rendered here -->
                    </div>
                </div>

                <!-- Grade Distribution -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>Grade Distribution</h3>
                    </div>
                    <div id="gradeDistribution" class="grade-distribution">
                        <!-- Grade distribution will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- Performance Grid -->
            <div class="performance-grid">
                <!-- Course Performance -->
                <div class="performance-card">
                    <h3>
                        <i class='bx bx-book'></i>
                        Course Performance
                    </h3>
                    <div id="coursePerformance" class="course-list">
                        <!-- Course performance will be rendered here -->
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="performance-card">
                    <h3>
                        <i class='bx bx-time-five'></i>
                        Recent Activity
                    </h3>
                    <div id="activityTimeline" class="activity-timeline">
                        <!-- Activity timeline will be rendered here -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="../../shared/utils/page-transition.js"></script>
    <script src="../utils/notifications.js"></script>
    <script src="../utils/dashboard.js"></script>
    <script src="../utils/analytics.js"></script>
    <script src="../utils/global-search.js"></script>
    <script src="../utils/search-filters.js"></script>
    <script src="../utils/lazy-loader.js" defer></script>
    <script src="../utils/performance-monitor.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator && window.location.protocol !== 'file:') {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(reg => console.log('✅ Service Worker registered'))
                    .catch(err => console.error('❌ SW registration failed:', err));
            });
        }
    </script>
</body>
</html>
